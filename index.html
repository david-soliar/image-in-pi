<!DOCTYPE html>
<head>
    <title>Find image in pi!</title>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <script src="pi_1mil.js"></script>
    <script>
        let binary_img = "";
        let other_data = [];

        function search_for_match(){
            let search_match = pi_bin.indexOf(binary_img);
            /*-1 pokial to nenaslo, inak vrati index kde to zacina*/
            if (search_match==-1){
                document.getElementById("result").innerHTML = "No match";
            }
            else{
                document.getElementById("result").innerHTML = "Match on index " + search_match;
            }
        }

        function change_color(event){
            let div_id = event.target.id
            const index_array = div_id.split("_")

            index_array[0] = parseInt(index_array[0]);
            index_array[1] = parseInt(index_array[1]);

            let index = index_array[0]*other_data[0]+index_array[1]
            let x = binary_img[index];
            
            if (parseInt(x)){
                binary_img = binary_img.substring(0, index) + "0" + binary_img.substring(index+1);
                document.getElementById(div_id).style.backgroundColor = "white";
            }
            else {
                binary_img = binary_img.substring(0, index) + "1" + binary_img.substring(index+1);
                document.getElementById(div_id).style.backgroundColor = "#191919";
            }

            document.getElementById("text1").innerHTML = "Binary representation of your image: " + binary_img;
        }

        function update_page(){
            const divboard = document.getElementById('clickable-divs');
            divboard.replaceChildren();
            
            let div_option = parseInt(document.getElementById("resolution").value);
            other_data[0] = div_option;

            let grid_fr = "";
            binary_img = "";
            
            for(let x=0; x<div_option; x++){
                for (let y=0; y<div_option; y++){
                    var onediv = document.createElement('div');
                    onediv.className = "clickdiv";
                    onediv.id = `${x}_${y}`;
                        
                    const text = document.createTextNode(`${x}_${y}`);
                    onediv.appendChild(text);

                    divboard.appendChild(onediv);
                    onediv.addEventListener("click", change_color);
                    binary_img += "0";
                }
                grid_fr += "1fr ";
            }
            document.getElementById("clickable-divs").style.gridTemplateColumns = grid_fr;
            document.getElementById("text1").innerHTML = "Binary representation of your image: " + binary_img;
        }
    </script>
</head>
<body>
    <label for="resolution">Choose a resolution:</label>
    <select name="resolution" id="resolution">
        <option value="6">6x6</option>
        <option value="10">10x10</option>
        <option value="20">20x20</option>
        <option value="30">30x30</option>
        <option value="40">40x40</option>
    </select>
    <button id="b1" onclick="update_page()">Update/Reset resolution</button>
    <div id="clickable-divs">

    </div>
    <p id="text1"></p>
    <button id="b2" onclick="search_for_match()">Search the pi!</button>
    <div id="result"></div>
    <script>
        update_page();
    </script>
</body>